{"version":3,"sources":["missionary/impl/Rendezvous.cljs"],"mappings":";AAGA,iCAAA,jCAAMA;AAAN,AAAA;;AAEA,AAAA;;;;;;;;;;;AAAA,AAAA,CAAA,AAAA,iDAAA,WAAAC,5DAASU;;AAAT,AAAA,IAAAT,SAAA;AAAA,AAAA,IAAAC,WAAA,CAAA,AAAA,mBAAA;AAAA,AAAA,QAAAA;KAAA;AAAA,OAAAD,qCAAA,CAAA,UAAA;;;KAAA;AAAA,OAAAA,qCAAA,CAAA,UAAA,MAAA,CAAA,UAAA;;;;AAAA,MAAA,KAAAE,MAAA,CAAA,8DAAA,CAAA,AAAA,mBAAA;;;;;AAAA,CAAA,AAAA,kDAAA,WAAAF,OAAAG,pEAASM;;AAAT,AAAA,IAAAT,aAAA;AAAA,AAAA,OAAA,AAAAA,sBAAAA,WAAA,AAAA,CAAAA,mBAAA,AAAAI,iBAAAD;;;AAAA,CAAA,AAAA,0EAAA,1EAASM,qFAGKK;;AAHd,AAAA,QAAA,JAGYD;AAHZ,AAII,kBAAKE,QAAGC;AAAR,AACE,IAAAC,qBAAc,AAACI,cAAIV;AAAnB,AAAA,GAAA,CAAAM,sBAAA;AAGE,aAAA,TAAMG;AAAN,AAAS,sFAAA,0BAAA,xGAACL,wCAAAA,8CAAAA;;AAAV,AACE,CAAMH,iBAAQ,AAACW,8CAAMX,eAAQQ,OAAEN;;AADjC;AAAA,AAEG,GAAM,AAACU,0BAAUZ,eAAQQ;AAAzB,AACE,CAAMR,iBAAQ,AAACa,+CAAOb,eAAQQ;;AAC9B,IAAAM,WAAI,KAAAC,qBAAA;AAAJ,AAAA,sFAAAD,8BAAAA,5GAACV,wCAAAA,kDAAAA;;AAFH;;;;AALL,IAAAE,aAAAD;aAAA,AAAAE,4CAAAD,WAAA,IAAA,pEAAWE;AAAX,AACE,AAAI,CAAMT,iBAAQ,AAACW,6CAAKX,eAAQS;;AAC5B,CAACA,uCAAAA,0CAAAA,LAAEN,sBAAAA;;AAAG,+EAAA,0BAAA,xGAACC,wCAAAA,8CAAAA;;AAAQjB;;;;;AAP3B,CAAA,AAAA,0EAAA,1EAASW,qFAaKM,QAAGC;;AAbjB,AAAA,QAAA,JAaYH;AAbZ,AAcI,IAAAI,qBAAkB,AAACI,cAAIT;AAAvB,AAAA,GAAA,CAAAK,sBAAA;AAGE,aAAA,WAAAa,pBAAMV;AAAN,AAAS,sFAAAU,sCAAAA,pHAACf,wCAAAA,0DAAAA;;AAAV,AACE,CAAMJ,iBAAQ,AAACoB,6CAAKpB,eAAQS;;AAD9B;AAAA,AAEG,GAAM,AAACI,0BAAUb,eAAQS;AAAzB,AACE,CAAMT,iBAAQ,AAACW,6CAAKX,eAAQS;;AAC5B,IAAAY,WAAI,KAAAL,qBAAA;AAAJ,AAAA,sFAAAK,8BAAAA,5GAAChB,wCAAAA,kDAAAA;;AAFH;;;;AALL,IAAAY,aAAAX;IAAAY,aAAA,AAAAV,4CAAAS,WAAA,IAAA;aAAA,AAAAT,4CAAAU,WAAA,IAAA,pEAAYT;QAAZ,AAAAD,4CAAAU,WAAA,IAAA,/DAAcf;AAAd,AACE,AAAI,CAAMF,iBAAQ,AAACa,+CAAOb,eAAQQ;;AAC9B,CAACA,uCAAAA,yCAAAA;;AAAG,CAACL,wCAAAA,2CAAAA,LAAGD,uBAAAA;;AAAGhB;;;;AAhBrB,CAAA,2CAAA,3CAASW;AAAT,AAAA,AAAA;;;AAAA,CAAA,iDAAA,jDAASA;;AAAT,CAAA,oDAAA,pDAASA;;AAAT,CAAA,yDAAA,WAAAJ,mBAAAC,qBAAAC,5GAASE;AAAT,AAAA,OAAAD,iBAAAF,qBAAA;;;AAAA;;;uCAAA,vCAASI,sFAAgBC,QACAC;AADzB,AAAA,YAAAH,gCAAyBE,QACAC;;;AADhBH,AAuBT,kCAAA,lCAAMwB;AAAN,AAAc,4CAAA,kCAAA,vEAACvB","names":["missionary.impl.Rendezvous/nop","unused__11938__auto__","self__","G__39994","js/Error","args39988","cljs.core/aclone","this__5330__auto__","writer__5331__auto__","opt__5332__auto__","cljs.core/-write","missionary.impl.Rendezvous/Port","missionary.impl.Rendezvous/->Port","readers","writers","_","t","s!","f!","temp__5806__auto__","vec__40034","cljs.core.nth","!","cljs.core/seq","cljs.core.disj","cljs.core.assoc","cljs.core/contains?","cljs.core.dissoc","G__40021","js/missionary.Cancelled","vec__40064","vec__40067","p1__39980#","cljs.core.conj","G__40053","missionary.impl.Rendezvous/make"],"sourcesContent":["(ns missionary.impl.Rendezvous\n  (:import missionary.Cancelled))\n\n(defn nop [])\n\n(deftype Port [^:mutable readers\n               ^:mutable writers]\n  IFn\n  (-invoke [_ t]\n    (fn [s! f!]\n      (if-some [[!] (seq readers)]\n        (do (set! readers (disj readers !))\n            (! t) (s! nil) nop)\n        (let [! #(s! nil)]\n          (set! writers (assoc writers ! t))\n          #(when (contains? writers !)\n             (set! writers (dissoc writers !))\n             (f! (Cancelled. \"Rendez-vous give cancelled.\")))))))\n  (-invoke [_ s! f!]\n    (if-some [[[! t]] (seq writers)]\n      (do (set! writers (dissoc writers !))\n          (!) (s! t) nop)\n      (let [! #(s! %)]\n        (set! readers (conj readers !))\n        #(when (contains? readers !)\n           (set! readers (disj readers !))\n           (f! (Cancelled. \"Rendez-vous take cancelled.\")))))))\n\n(defn make [] (->Port #{} {}))\n"]}